created_at: '2026-01-27T15:00:00+08:00'
execution_order:
  phase_1_experiments:
    description: 运行关键实验 (突破停滞的关键)
    parallel: false
    rationale: '必须先运行实验获取数据，才能更新论文。

      这是提升 Technical Quality (40% 权重) 的唯一途径。

      '
    tasks:
    - M2_E2E_REPAIR
    - M3_PERPLEXITY
  phase_2_literature:
    description: 完善 Related Work
    parallel: true
    rationale: '可以与 Phase 1 并行，不依赖实验结果

      '
    tasks:
    - LITERATURE_RELATED_WORK
  phase_3_writing:
    description: 文字修改 (依赖实验结果)
    parallel: true
    rationale: '等实验完成后再修改论文，避免多次修改

      '
    tasks:
    - M1_SCOPE_CLARIFICATION
    - m7_FIG5_LABELS
issues:
- actions:
  - agent: experimenter
    expected_output: results/rap_svd_misaligned/ 目录包含压缩后的不对齐模型
    status: pending
    step: 1
    task: "使用 RAP SVD 压缩模型创建不对齐维度:\n\n1. 检查 third_party/RAP/prune.py 的 --attention\
      \ svd 模式\n2. 运行压缩:\n   python third_party/RAP/prune.py \\\n     --model meta-llama/Meta-Llama-3-8B-Instruct\
      \ \\\n     --attention svd \\\n     --retain-ratio 0.8 \\\n     --save-model\
      \ ./results/rap_svd_misaligned/\n3. 验证输出模型的 head_dim 分布（应该有不对齐值如 102, 103 等）\n\
      4. 记录维度分布到 results/rap_svd_misaligned/dims.json\n\n注意: 需要 80GB GPU (A100_80GB)，预计\
      \ 2-4 小时\n"
  - agent: experimenter
    depends_on:
    - 1
    expected_output: results/rap_svd_repaired/ 目录包含修复后的模型
    status: pending
    step: 2
    task: '对 RAP SVD 模型运行 dimension repair:


      1. 加载 RAP SVD 压缩模型

      2. 运行 DimensionRepairer 修复不对齐维度

      3. 保存修复后的模型到 results/rap_svd_repaired/

      4. 记录修复前后的维度变化

      '
  - agent: experimenter
    depends_on:
    - 2
    expected_output: results/rap_svd_e2e/comparison.json 包含对比数据
    status: pending
    step: 3
    task: "运行 E2E benchmark 对比:\n\npython -m src.gcompress_bench.llm_run \\\n  --variant\
      \ rap_svd \\\n  --suite infer_sweep \\\n  --out results/rap_svd_e2e/\n\npython\
      \ -m src.gcompress_bench.llm_run \\\n  --variant rap_svd_repair \\\n  --suite\
      \ infer_sweep \\\n  --out results/rap_svd_e2e/\n\n对比指标:\n- Prefill throughput\
      \ (tok/s)\n- Decode throughput (tok/s)\n- Memory usage (MB)\n"
  - agent: writer
    depends_on:
    - 3
    expected_output: 论文中有 E2E repair 验证数据
    status: pending
    step: 4
    task: '更新论文 Table 6 和 Figure 6:


      1. 添加 RAP_SVD 和 RAP_SVD+Repair 行到 Table 6

      2. 更新 Figure 6 展示 repair speedup

      3. 在 §6.4 添加讨论 repair 对不对齐模型的效果

      '
  depends_on: []
  description: '**Reviewer M2 原文**:

    "The E2E evaluation shows PaLU compression benefits (11.5× decode speedup)

    but not dimension repair benefits. This is because the tested PaLU model

    has aligned dimensions."


    **为什么之前无法解决**:

    - 所有 PaLU checkpoint 都使用 32-倍数量化约束，100% 对齐

    - 无法用 PaLU 模型演示 repair 效果


    **解决方案**:

    findings.yaml 已发现 RAP SVD 不强制对齐！

    - PaLU: block_size=32 强制对齐

    - RAP SVD: round(head_dim * retain_ratio) 任意整数


    **实验设计**:

    1. 使用 RAP SVD 压缩 Llama-3-8B (retain_ratio=0.8)

    2. 预期得到 head_dim=102 (不是 8 的倍数)

    3. 运行 E2E benchmark: RAP_SVD vs RAP_SVD+Repair

    4. 展示 repair 带来的 speedup

    '
  id: M2_E2E_REPAIR
  inner_loop_count: 2
  max_inner_loops: 3
  priority: critical
  status: completed
  title: E2E Validation with Misaligned Dimensions (RAP SVD)
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: experimenter
    expected_output: results/perplexity/ 目录包含 perplexity 数据
    status: pending
    step: 1
    task: "运行 perplexity 评估:\n\n1. 对 baseline (原始模型):\n   python -m src.gcompress_bench.llm_eval\
      \ \\\n     --variant baseline \\\n     --suite ppl \\\n     --out results/perplexity/\n\
      \n2. 对 PaLU 压缩模型:\n   python -m src.gcompress_bench.llm_eval \\\n     --variant\
      \ palu \\\n     --suite ppl \\\n     --out results/perplexity/\n\n3. 对 PaLU\
      \ + Repair (如果适用):\n   python -m src.gcompress_bench.llm_eval \\\n     --variant\
      \ palu_repair \\\n     --suite ppl \\\n     --out results/perplexity/\n\n记录\
      \ WikiText-2 perplexity 值\n"
  - agent: writer
    depends_on:
    - 1
    expected_output: 论文中有 perplexity 验证数据
    status: pending
    step: 2
    task: '在论文 §6.5 Accuracy Preservation 中添加:


      1. WikiText-2 perplexity 表格

      2. 说明 repair 不影响模型精度

      3. 引用具体数值（如 baseline: X.XX, repaired: X.XX）

      '
  depends_on: []
  description: '**Reviewer M3 原文**:

    "Unit tests confirm identical outputs (30/30 passed) is insufficient for a

    systems paper targeting EuroMLSys. The claim of bit-exact preservation needs

    validation on meaningful workloads."


    **Suggested Fix**:

    "Run perplexity evaluation on WikiText-2 comparing original vs. repaired models"


    **为什么重要**:

    - 技术验证不足是 Technical Quality 评分的主要扣分点

    - Perplexity 是 LLM 压缩论文的标准验证方法

    '
  id: M3_PERPLEXITY
  inner_loop_count: 1
  max_inner_loops: 2
  priority: high
  status: completed
  title: Perplexity Validation on WikiText-2
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: literature
    expected_output: literature.yaml 更新，包含 vLLM/TensorRT-LLM 详细信息
    status: pending
    step: 1
    task: '完善 Related Work 调研:


      1. 确认 vLLM 对不支持 head_dim 的 fallback 行为

      2. 调研 TensorRT-LLM 的 dimension 处理策略

      3. 搜索最新 2024-2025 关于 LLM inference 维度优化的论文


      更新 literature.yaml

      '
  - agent: writer
    depends_on:
    - 1
    expected_output: 论文 Related Work 更完善
    status: pending
    step: 2
    task: '在论文 §7 Related Work 中添加:


      1. vLLM 的 FlashAttentionBackend head_dim 限制

      2. 与 TensorRT-LLM padding 策略的对比

      3. 说明我们的方法与现有框架的关系

      '
  depends_on: []
  description: '**Reviewer 原文**:

    "The paper lacks comparison with other dimension handling strategies in

    production inference frameworks (vLLM, TensorRT-LLM padding strategies)."


    **[NEEDS_LITERATURE_SEARCH: related_work]**

    - vLLM dimension alignment handling

    - TensorRT-LLM implicit padding

    - LLM inference dimension constraints 2024-2025


    **literature.yaml 已有数据**:

    - vLLM FlashAttentionBackend 限制 head_dim: [64, 80, 96, 112, 128, 256]

    - TensorRT-LLM 有内置 padding 策略（待验证）

    '
  id: LITERATURE_RELATED_WORK
  inner_loop_count: 0
  max_inner_loops: 1
  priority: medium
  status: completed
  title: Enhance Related Work with vLLM/TensorRT-LLM Comparison
  type: LITERATURE_REQUIRED
- actions:
  - agent: writer
    expected_output: 论文 scope 更清晰
    status: pending
    step: 1
    task: '修改论文中的 scope 说明:


      1. 在 Figure 2 标题开头加 "**Theoretical**"

      2. 在 §3 开头添加醒目的 scope 段落

      3. 如果有 RAP SVD 数据，添加真实不对齐模型的例子


      关键文字修改:

      "While production PaLU checkpoints enforce 32-multiple alignment (100% aligned),

      other SVD compression methods like RAP-SVD produce truly irregular dimensions.

      Our repair targets these unconstrained compression scenarios."

      '
  depends_on:
  - M2_E2E_REPAIR
  description: '**Reviewer M1 原文**:

    "Figure caption says ''Theoretical dimension distribution'' but the paper uses

    this 96.9% misalignment figure as motivation throughout. Readers may incorrectly

    assume real compressed models have this distribution."


    **注意**: 如果 M2_E2E_REPAIR 成功，我们会有真实不对齐模型的数据，

    可以大幅改善这个问题。

    '
  id: M1_SCOPE_CLARIFICATION
  inner_loop_count: 0
  max_inner_loops: 1
  priority: medium
  status: completed
  title: Make 'Theoretical' Scope More Prominent
  type: WRITING_ONLY
- actions:
  - agent: writer
    expected_output: Figure 5 标签不再重叠
    status: pending
    step: 1
    task: '修改 scripts/create_paper_figures.py 中 Figure 5 的绘制代码:


      方案 1 (推荐): 使用 adjustText 库自动调整标签位置

      方案 2: 使用 leader lines (箭头) 连接标签和数据点

      方案 3: 手动 stagger 标签位置


      重新生成 Latex/figures/fig5_repair_tradeoff.pdf

      '
  depends_on: []
  description: '**Reviewer 原文 (标记为 CRITICAL)**:

    "Data point labels (d=107, d=114, d=117, d=120, d=121, d=125) overlap severely

    in upper-left region where d=107, d=121, d=125 labels collide."


    这是 Reviewer 唯一标记为 CRITICAL 的视觉问题。

    '
  id: m7_FIG5_LABELS
  inner_loop_count: 0
  max_inner_loops: 1
  priority: medium
  status: completed
  title: Fix Figure 5 Label Overlap (CRITICAL Visual Issue)
  type: WRITING_ONLY
notes:
- '本轮策略核心变化: 从 WRITING_ONLY 转向 EXPERIMENT_REQUIRED'
- M2 是最关键任务 - 如果成功，可同时解决 E2E 验证和 scope 问题
- M3 是次关键任务 - perplexity 是 EuroMLSys 的标准验证要求
- 如果实验失败，下轮需要考虑 downscope contribution
- RAP SVD 实验预计需要 4-8 小时 GPU 时间
planner_summary: '**严重停滞警告**: 已达 100+ 次迭代停留在 7.25，之前的策略完全无效。


  **根本原因分析**:

  之前的 action plan 全部标记为 "completed"，但分数未变。这说明：

  1. 纯文字修改无法提升分数（Reviewer 权重 Technical Quality 40%）

  2. Review 的三个 Major Issues 都需要实质性改变，不只是文字调整


  **Reviewer 真正关心的问题**:

  - M1: 96.9% 数据是"理论"值，不是实际 PaLU 模型（需要更明显的 scope 声明）

  - M2: E2E 验证只展示压缩收益，不是 repair 收益（核心技术缺陷）

  - M3: 只有 unit tests 验证 accuracy，缺少 perplexity（技术验证不足）


  **新策略 - 突破停滞**:

  1. **EXPERIMENT_REQUIRED (M2)**: 使用 RAP SVD 创建真正不对齐的模型，运行 E2E repair 验证

  2. **EXPERIMENT_REQUIRED (M3)**: 运行 WikiText-2 perplexity 评估

  3. **LITERATURE_REQUIRED**: 完善 Related Work（review 明确提出）

  4. **WRITING_ONLY**: 只做必要的文字修改，不浪费时间在低优先级任务


  **预期效果**:

  - Technical Quality: 7.5 → 8.0 (通过 M2, M3 实验)

  - Paper Presentation: 7.0 → 7.5 (通过文字改进)

  - 总分: 7.25 → 7.75+

  '
review_iteration: 15
review_score: 7.25
stagnation_analysis:
  iterations_without_progress: 100+
  new_approach: '**策略升级 - Level 3: 重新定位**


    聚焦于 Technical Quality (40% 权重):

    1. 运行 RAP SVD E2E 实验 (M2 核心需求)

    2. 运行 perplexity 评估 (M3 核心需求)

    3. 补充 Related Work 对比 (文献需求)


    放弃低价值任务:

    - 不再修改图表样式 (已多次尝试无效)

    - 不再优化 caption/footnote (边际效益极低)

    '
  previous_approaches:
  - 图表修复 (FIG_M1-M4) - 已完成，无效果
  - 文字修改 (conclusion, caption) - 已完成，无效果
  - Table 格式 (N/A notation) - 已完成，无效果
  why_stagnated: '1. 之前只做 WRITING_ONLY 任务，无法提升 Technical Quality (40% 权重)

    2. 所有图表修复任务完成但分数不变，说明 Reviewer 不认为这是关键

    3. 核心缺陷未解决: E2E repair 验证 + perplexity 评估

    '
success_criteria:
  expected_score_improvement:
    current: 7.25
    rationale: '如果 M2 和 M3 实验成功:

      - Technical Quality: 7.5 → 8.0 (+0.2 weighted)

      - Paper Presentation: 7.0 → 7.5 (+0.15 weighted)

      - Total: 7.25 → 7.60+


      如果还完成 Related Work 改进:

      - Innovation: 7.0 → 7.3 (+0.06 weighted)

      - Total: 可能达到 7.75

      '
    target: 7.75
  must_complete:
  - 'M2_E2E_REPAIR: 运行 RAP SVD E2E 实验，获取 repair speedup 数据'
  - 'M3_PERPLEXITY: 运行 perplexity 评估，证明 accuracy preservation'
  nice_to_have:
  - 'm7_FIG5_LABELS: 修复 Figure 5 标签重叠'
  should_complete:
  - 'LITERATURE_RELATED_WORK: 完善 Related Work'
  - 'M1_SCOPE_CLARIFICATION: 明确 scope'
writing_tasks:
- changes_required:
  - change: 标题开头加 **Theoretical**
    section: Figure 2
  - change: 添加醒目的 scope 段落
    section: §3
  description: 修改 scope 说明
  id: M1_SCOPE_CLARIFICATION
  target_files:
  - Latex/main.tex
- changes_required:
  - change: 使用 adjustText 或 leader lines 避免标签重叠
    section: plot_repair_tradeoff()
  description: 修复 Figure 5 标签重叠
  id: m7_FIG5_LABELS
  target_files:
  - scripts/create_paper_figures.py
  - Latex/figures/fig5_repair_tradeoff.pdf
